import { Component, OnInit } from '@angular/core';
import * as Xml2js from 'xml2js';

@Component({
  selector: 'app-home',
  templateUrl: './home.page.html',
  styleUrls: ['./home.page.scss'],
})

export class HomePage implements OnInit {

  constructor() { }

  ngOnInit() {
    //These 8 lines below are just for testing and looking at how the XML is nested.
    var parse = Xml2js.parseString;
    //Mock XML goes here.
    var xml = '<items termsofuse=""><item type="boardgame" id="131357"><thumbnail>https://cf.geekdo-images.com/thumb/img/ZsRtgIExTwWphMDZPH1hG-CR8os=/fit-in/200x150/pic2016054.jpg</thumbnail><image>https://cf.geekdo-images.com/original/img/4zmqrQ4v-rufRQM_oinFDQ6HykI=/0x0/pic2016054.jpg</image><name type="primary" sortindex="1" value="Coup"/><description> You are head of a family in an Italian city-state, a city run by a weak and corrupt court. You need to manipulate, bluff and bribe your way to power. Your object is to destroy the influence of all the other families, forcing them into exile. Only one family will survive...&#10;&#10;In Coup, you want to be the last player with influence in the game, with influence being represented by face-down character cards in your playing area.&#10;&#10;Each player starts the game with two coins and two influence &ndash; i.e., two face-down character cards; the fifteen card deck consists of three copies of five different characters, each with a unique set of powers:&#10;&#10;&#10; Duke: Take three coins from the treasury. Block someone from taking foreign aid.&#10; Assassin: Pay three coins and try to assassinate another player\'s character.&#10; Contessa: Block an assassination attempt against yourself.&#10; Captain: Take two coins from another player, or block someone from stealing coins from you.&#10; Ambassador: Draw two character cards from the Court (the deck), choose which (if any) to exchange with your face-down characters, then return two. Block someone from stealing coins from you.&#10;&#10;&#10;On your turn, you can take any of the actions listed above, regardless of which characters you actually have in front of you, or you can take one of three other actions:&#10;&#10;&#10; Income: Take one coin from the treasury.&#10; Foreign aid: Take two coins from the treasury.&#10; Coup: Pay seven coins and launch a coup against an opponent, forcing that player to lose an influence. (If you have ten coins or more, you must take this action.)&#10;&#10;&#10;When you take one of the character actions &ndash; whether actively on your turn, or defensively in response to someone else\'s action &ndash; that character\'s action automatically succeeds unless an opponent challenges you. In this case, if you can\'t (or don\'t) reveal the appropriate character, you lose an influence, turning one of your characters face-up. Face-up characters cannot be used, and if both of your characters are face-up, you\'re out of the game.&#10;&#10;If you do have the character in question and choose to reveal it, the opponent loses an influence, then you shuffle that character into the deck and draw a new one, perhaps getting the same character again and perhaps not.&#10;&#10;The last player to still have influence &ndash; that is, a face-down character &ndash; wins the game!&#10;&#10;A new &amp; optional character called the Inquisitor has been added (currently, the only English edition with the Inquisitor included is the Kickstarter Version from Indie Boards &amp; Cards. Copies in stores may not be the Kickstarter versions and may only be the base game). The Inquisitor character cards may be used to replace the Ambassador cards.&#10;&#10;&#10; Inquisitor: Draw one character card from the Court deck and choose whether or not to exchange it with one of your face-down characters. OR Force an opponent to show you one of their character cards (their choice which). If you wish it, you may then force them to draw a new card from the Court deck. They then shuffle the old card into the Court deck. Block someone from stealing coins from you.&#10;&#10;&#10; </description></item></items>';
    //XML becomes multiple nested strings
    parse(xml, function (err, result) {
        //Dig through nested XML to get name, print to console.
        console.dir(result/*.items.item[0].name[0].$.value*/);
    });
    //Runs the function.
    this.showGameName();
  }

  showGameName() {
    var parse = Xml2js.parseString;
    //Mock XML goes here.
    var xml = '<items termsofuse=""><item type="boardgame" id="131357"><thumbnail>https://cf.geekdo-images.com/thumb/img/ZsRtgIExTwWphMDZPH1hG-CR8os=/fit-in/200x150/pic2016054.jpg</thumbnail><image>https://cf.geekdo-images.com/original/img/4zmqrQ4v-rufRQM_oinFDQ6HykI=/0x0/pic2016054.jpg</image><name type="primary" sortindex="1" value="Coup"/><description> You are head of a family in an Italian city-state, a city run by a weak and corrupt court. You need to manipulate, bluff and bribe your way to power. Your object is to destroy the influence of all the other families, forcing them into exile. Only one family will survive...&#10;&#10;In Coup, you want to be the last player with influence in the game, with influence being represented by face-down character cards in your playing area.&#10;&#10;Each player starts the game with two coins and two influence &ndash; i.e., two face-down character cards; the fifteen card deck consists of three copies of five different characters, each with a unique set of powers:&#10;&#10;&#10; Duke: Take three coins from the treasury. Block someone from taking foreign aid.&#10; Assassin: Pay three coins and try to assassinate another player\'s character.&#10; Contessa: Block an assassination attempt against yourself.&#10; Captain: Take two coins from another player, or block someone from stealing coins from you.&#10; Ambassador: Draw two character cards from the Court (the deck), choose which (if any) to exchange with your face-down characters, then return two. Block someone from stealing coins from you.&#10;&#10;&#10;On your turn, you can take any of the actions listed above, regardless of which characters you actually have in front of you, or you can take one of three other actions:&#10;&#10;&#10; Income: Take one coin from the treasury.&#10; Foreign aid: Take two coins from the treasury.&#10; Coup: Pay seven coins and launch a coup against an opponent, forcing that player to lose an influence. (If you have ten coins or more, you must take this action.)&#10;&#10;&#10;When you take one of the character actions &ndash; whether actively on your turn, or defensively in response to someone else\'s action &ndash; that character\'s action automatically succeeds unless an opponent challenges you. In this case, if you can\'t (or don\'t) reveal the appropriate character, you lose an influence, turning one of your characters face-up. Face-up characters cannot be used, and if both of your characters are face-up, you\'re out of the game.&#10;&#10;If you do have the character in question and choose to reveal it, the opponent loses an influence, then you shuffle that character into the deck and draw a new one, perhaps getting the same character again and perhaps not.&#10;&#10;The last player to still have influence &ndash; that is, a face-down character &ndash; wins the game!&#10;&#10;A new &amp; optional character called the Inquisitor has been added (currently, the only English edition with the Inquisitor included is the Kickstarter Version from Indie Boards &amp; Cards. Copies in stores may not be the Kickstarter versions and may only be the base game). The Inquisitor character cards may be used to replace the Ambassador cards.&#10;&#10;&#10; Inquisitor: Draw one character card from the Court deck and choose whether or not to exchange it with one of your face-down characters. OR Force an opponent to show you one of their character cards (their choice which). If you wish it, you may then force them to draw a new card from the Court deck. They then shuffle the old card into the Court deck. Block someone from stealing coins from you.&#10;&#10;&#10; </description></item></items>';
    //XML becomes multiple nested strings
    parse(xml, function (err, result) {
      //Dig through nested XML to get name, print to page.
      //gameName = result.items.item[0].name[0].$.value;
      document.getElementById("gameName").innerHTML = result.items.item[0].name[0].$.value;
      document.getElementById("gameDesc").innerHTML = result.items.item[0].description[0];
    });
  }

}
